<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Random number</title>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>

<link href="160324.css" rel="stylesheet" type="text/css" />
<style type="text/css">
.style7 {color: #000000; }
</style>
</head>

<body>
<p class="X-Large-Bold-RED">ランダムな数の発生方法-04-2</p>
<p class="Large-Bold-Red">誤差関数を使って表してみる</p>
<p>\(\Large  Rand_{0-1} = \frac{1}{ \sqrt{ \mathstrut 2 \ \pi \ \sigma^2}} \int_{-\infty}^x   e^{- \frac{t^2}{2  \sigma^2}}　dt \)　</p>
<p>誤差関数は，</p>
<p>\(\Large  erf (x) = \frac{1}{ \sqrt{  \pi }} \int_{0}^x   e^{- t^2}　dt \)　</p>
<p>ですので，変数変換して，</p>
<p>\(\Large   \frac{t^2}{2  \sigma^2} \equiv w^2 \ \rightarrow \frac{t}{\sqrt{2}  \sigma} = w \ \rightarrow \ \frac{dt}{\sqrt{2}  \sigma} = dw\)　</p>
<p>\(\Large   0 \sim t \sim x\)　</p>
<p>\(\Large   0 \sim \ w \sim \ \frac{x}{\sqrt{2}  \sigma} \)　</p>
<p>となるので，</p>
<p>\(\Large  Rand_{0-1} = \frac{1}{ \sqrt{ \mathstrut 2 \ \pi \ \sigma^2}} \displaystyle \int_{-\infty}^{x / \sqrt{2} \sigma}   e^{- w^2}　dw \cdot \sqrt{2} \sigma \)　</p>
<p>\(\Large  = \frac{1}{ \sqrt{  \pi }} \displaystyle \int_{-\infty}^{x / \sqrt{2} \sigma}   e^{- w^2}　dw  \)　</p>
<p>\(\Large  = \frac{1}{ \sqrt{  \pi }} \left[ \displaystyle \int_{-\infty}^{0}   e^{- w^2}　dw + \int_{0}^{x / \sqrt{2} \sigma}   e^{- w^2}　dw\right] \)　</p>
<p>誤差関数から，</p>
<p>\(\Large  erf (- \infty) = \frac{1}{ \sqrt{  \pi }} \displaystyle \int_{0}^{- \infty}   e^{- t^2}　dt = -1\)　</p>
<p>\(\Large   \displaystyle \int_{0}^{- \infty}   e^{- t^2}　dt = - \frac{ \sqrt{ \pi}}{2} \rightarrow \displaystyle \int_{- \infty}^0   e^{- t^2}　dt =  \frac{ \sqrt{ \pi}}{2} \)　</p>
<p>となるので，</p>
<p>\(\Large  Rand_{0-1} = \frac{1}{ \sqrt{  \pi }} \left[ \displaystyle \int_{-\infty}^{0}   e^{- w^2}　dw + \int_{0}^{x / \sqrt{2} \sigma}   e^{- w^2}　dw\right] \)　</p>
<p>\(\Large   = \frac{1}{ \sqrt{  \pi }} \left[ \frac{ \sqrt{2}}{2} + \frac{ \sqrt{2}}{2} \cdot erf \left(\frac{x}{ \sqrt{2} \sigma}   \right) \right] \)　</p>
<p>\(\Large   = \frac{1}{ 2} \left[ 1 + erf \left(\frac{x}{ \sqrt{2} \sigma}   \right) \right] \)　</p>
<p>となります．誤差関数の逆関数を，erf<sup>-1</sup>，とすると</p>
<p>\(\Large   erf \left(\frac{x}{ \sqrt{2} \sigma}   \right) = 2 Rand_{0-1}-1 \)　</p>
<p>\(\Large   \frac{x}{ \sqrt{2} \sigma}    = erf^{-1} (2 \ Rand_{0-1}-1) \)　</p>
<p>\(\Large   x =  \sqrt{2} \sigma \cdot erf^{-1} (2 \ Rand_{0-1}-1) \)　</p>
<p>となり，０から１のランダム関数と誤差の逆関数を用いれば，正規分布の各点を求めることができます．</p>
<p>実際に，σ=1，で１万回，試行したところ，</p>
<p><img src="Random number-01.png" width="567" height="311" alt=""/></p>
<p>のように，標準偏差が１，の正規分布となりました．</p>
<p>実際のプログラムでどう扱うかを次ページに示していきます．</p>
<p>&nbsp;</p>
<p><span class="style7"><a href="Random number-04.html"><img src="L-arrow.png" alt="l" width="57" height="34" border="0" /></a> <a href="index.html"><img src="TOP.png" alt="t" width="57" height="34" /></a></span><a href="Random number-05.html"><img src="R-arrow.png" alt="r" width="57" height="34" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
